#!/bin/sh

# copy this file to .git/hooks (i.e., overwrite the file .git/hooks/pre-commit)
# to perform source checks before commits

FILES=`git diff --cached --name-status HEAD | \
  awk '$1 != "R" { print $2 }'       | \
  grep -v -e 'src/external'          | \
  grep -e '.*\.c$' -e '.*\.h$'`

if [ ${#FILES} -gt 0 ]
then
  $PWD/scripts/src_check $FILES
fi
